---
title: "Stat Project"
author: "Parijat"
date: "3/17/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
load("~/Desktop/Winter/Hypothesis-Testing-for-Linear-Models/Project/train.RData")
load("~/Desktop/Winter/Hypothesis-Testing-for-Linear-Models/Project/test.RData")
```


## Exploratory Analysis

```{r Exploratory Analysis}

data_u = data1[,-c(21,3,43,8,29)]
data_i = data1[, c(21,3,43,8,29)]
colnames_datau = colnames(data_u)
colnames_datai = colnames(data_i)


na_count_before = vector(length = dim(data_u)[2])
unique_values = vector(length = dim(data_u)[2])
na_count_after = vector(length = dim(data_u)[2])




data_u = data_u[,-c(4,48)]
lm_complete_case = lm(SalePrice ~ . , data = data_u)
summary = summary(lm_complete_case)

data_u_copy = data_u[,]


for(i in 1:dim(data_u_copy)[2]){

  column = data_u_copy[,i]

  na_count_before[i] = sum(is.na(column))

  factor_count = length(table(column))

  if(factor_count <=20 && na_count_before[i]>0){
    lvl = levels(data_u_copy[,i])
    levels(data_u_copy[,i]) = c(lvl,"None")
    data_u_copy[is.na(data_u_copy[,i]),i] = "None"
  } else if(na_count_before[i]>0){
    #print(na_count_before[i])
    #print(floor(mean(column,na.rm = TRUE)))
  data_u_copy[is.na(data_u_copy[,i]),i] = floor(mean(column,na.rm = TRUE))
}

  na_count_after[i] = sum(is.na(data_u_copy[,i]))
}




```

